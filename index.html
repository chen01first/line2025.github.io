<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>è”¡è€å¸«æ•¸å­—DNAåˆ†æå·¥å…· - ç°¡åŒ–æ¸¬è©¦</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body class="bg-gray-100 text-gray-800">
    <div class="max-w-5xl mx-auto p-4 space-y-6">
        <header class="text-center">
            <h1 class="text-3xl font-bold text-indigo-700">è”¡è€å¸«æ•¸å­—DNAåˆ†æå·¥å…· - ç°¡åŒ–æ¸¬è©¦</h1>
            <p class="text-gray-600 mt-2">åƒ…æ¸¬è©¦å‰å¾Œç«¯é€£ç·š</p>
        </header>

        <div class="bg-white p-6 rounded-lg shadow">
            <div class="input-section space-y-4">
                <h2 class="text-xl font-semibold text-indigo-700"><i class="fas fa-mobile-alt"></i> æ‰‹æ©Ÿè™Ÿç¢¼å›å‚³æ¸¬è©¦</h2>
                <div class="form-group">
                    <label for="phone-number" class="block text-sm font-medium text-gray-700">è¼¸å…¥ä»»æ„æ•¸å­—ï¼š</label>
                    <input type="text" id="phone-number" placeholder="è«‹è¼¸å…¥æ•¸å­—"
                        class="mt-1 w-full border border-gray-300 rounded px-3 py-2">
                </div>
                <div class="button-group flex space-x-2">
                    <button id="analyze-phone-btn"
                        class="btn bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded">æ¸¬è©¦å›å‚³</button>
                    <button id="reset-phone-btn"
                        class="btn bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded">æ¸…é™¤</button>
                </div>
            </div>
        </div>

        <section id="analysis-summary" class="bg-white p-6 rounded-lg shadow hidden">
            <h2 class="text-xl font-semibold text-indigo-700 mb-3">ğŸ” å›å‚³çµæœ</h2>
            <p class="text-gray-700" id="summary-text"></p>
        </section>
    </div>

    <script>
        // è«‹å‹™å¿…å°‡æ­¤ URL æ›¿æ›ç‚ºæ‚¨æ–°éƒ¨ç½² Apps Script å¾Œå–å¾—çš„ URL
        const APPS_SCRIPT_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbyzPQkLaGFs4YX-tRihWG2tJl_AHiYqy_yX4pwn2p7h0kpWnxZEdG_9B94zG_imi4ec/exec'; // æ›¿æ›ç‚ºæ‚¨çš„æ–° URL

        document.getElementById('analyze-phone-btn').addEventListener('click', analyzePhoneNumber);
        document.getElementById('reset-phone-btn').addEventListener('click', resetAnalysis);

        function resetAnalysis() {
            document.getElementById('phone-number').value = '';
            document.getElementById('analysis-summary').classList.add('hidden');
            document.getElementById('summary-text').innerHTML = '';
        }

        async function analyzePhoneNumber() {
            const phoneNumber = document.getElementById('phone-number').value.trim();

            if (!phoneNumber) {
                alert('è«‹è¼¸å…¥æ•¸å­—é€²è¡Œæ¸¬è©¦ï¼');
                return;
            }

            document.getElementById('summary-text').innerHTML = 'å‚³é€ä¸­...';
            document.getElementById('analysis-summary').classList.remove('hidden');

            try {
                /*const response = await fetch(`<span class="math-inline">\{APPS\_SCRIPT\_WEB\_APP\_URL\}?phoneNumber\=</span>{phoneNumber}`);*/
                const response = await fetch(`${APPS_SCRIPT_WEB_APP_URL}?phoneNumber=${phoneNumber}`); 

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();

                // æª¢æŸ¥å¾Œç«¯å›å‚³çš„ receivedNumber
                if (data && data.receivedNumber) {
                    document.getElementById('summary-text').innerHTML = `å¾å¾Œç«¯æ”¶åˆ°çš„æ•¸å­—æ˜¯ï¼š<span class="font-bold text-indigo-900">${data.receivedNumber}</span>`;
                } else {
                    document.getElementById('summary-text').innerHTML = `å¾Œç«¯å›å‚³æ ¼å¼ä¸ç¬¦ï¼Œè«‹æª¢æŸ¥ï¼<pre>${JSON.stringify(data, null, 2)}</pre>`;
                }

            } catch (error) {
                console.error('Error fetching data from GS:', error);
                alert('é€£æ¥å¾Œç«¯ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°ã€‚');
                resetAnalysis();
            }
        }
    </script>
</body>

</html>